
@using WebQACustomerArea.Models
@model List<GioHang>
@{
    ViewBag.Title = "Giỏ hàng";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link rel="stylesheet" href="~/Content/userCss.css" type="text/css" />
@section footerJS{
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="~/Scripts/shoppingCart.js"></script>
}
<div class="single_top">
    <div class="single_grid">
        <div id="cartContent">
            <table class="table text-center table-striped table-hover">
                <thead>
                    <tr>
                        <th>Mã sản phẩm</th>
                        <th>Tên sản phẩm</th>
                        <th>Hình ảnh</th>
                        <th>Giá</th>
                        <th>Số lượng</th>
                        <th>Thành tiền</th>
                    </tr>
                </thead>
                <tbody id="cartBody">
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>@item.maSP</td>
                            <td>@item.tenSP</td>
                            <td><img src="@Url.Content("~/Images/"+@item.hinhanh)" width="100" class="img-fluid"></td>
                            <td> @String.Format("{0:0,0}", @item.dongia) VNĐ</td>
                            @using (Html.BeginForm("capnhatgiohang", "GioHang", new { @maSP = item.maSP }))
                            {
                                <td style="width:10%"> <input style="width:50%" id="txtSoLuong" name="txtSoLuong" class="form-control" type="number" value="@item.soluong" /> </td>
                                <td> @String.Format("{0:0,0}", @item.thanhtien) VNĐ </td>
                                <td>
                                    <input class="btn btn-primary" type="submit" value="Cập nhật" />
                                </td>
                            }
                        </tr>
                    }
                </tbody>
            </table>
            <div class="container">
                <button class="btn btn-success" id="btnContinue">Tiếp tục mua hàng</button>
                <a class="btn btn-danger" href="@Url.Action("xoagiohangAll", "GioHang")" >Xóa giỏ hàng</a>
                <div class="modal fade" id="exampleModalScrollable" tabindex="-1" aria-labelledby="exampleModalScrollableTitle" style="display: none;" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-scrollable">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title text-center text-info" id="exampleModalScrollableTitle">Thanh toán</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="contact_right">
                                    <div class="contact-form">
                                        <form method="post" id="frmPayment">
                                            @if (Request.IsAuthenticated)
                                            {
                                                <label>
                                                    <input type="checkbox" id="chkUserLoginInfo" />
                                                    Sử dụng thông tin đăng nhập
                                                </label>
                                            }
                                            <div class="mb-1">
                                                <label for="txtName" class="">Họ và tên</label>
                                                <input type="text" name="name" class="form-control" id="txtName" placeholder="Họ và tên">
                                            </div>
                                            <div class="mb-1">
                                                <label for="txtAddress" class="">Địa chỉ</label>
                                                <input type="text" name="Order_DeliveryAddress" class="form-control" id="txtAddress" placeholder="Địa chỉ">
                                            </div>
                                            <div class="mb-1">
                                                <label for="txtEmail" class="">Địa chỉ Email</label>
                                                <input type="email" name="email" class="form-control" id="txtEmail" placeholder="name@example.com">
                                            </div>
                                            <div class="mb-1">
                                                <label for="txtPhone" class="">Số điện thoại</label>
                                                <input type="tel" name="Order_DeliveryContact" class="form-control" id="txtPhone" placeholder="Số điện thoại">
                                            </div>
                                            <div class="mb-3">
                                                <label for="txtMessage" class="">Nội dung thanh toán</label>
                                                <textarea class="form-control" id="txtMessage" rows="3"></textarea>
                                            </div>

                                            <label class="form-check-label"><input type="radio" id="rdoCash" class="form-check-input" name="paymentMethod" value="CASH" checked="checked" /> Tiền mặt</label>
                                            <label class="form-check-label"><input type="radio" id="rdoBank" class="form-check-input" value="ATM_ONLINE" name="paymentMethod" /> Thẻ Ngân hàng nội địa</label>
                                            <div id="bankContent" class="boxContent" style="display:none;">
                                                Danh sách ngân hàng nội địa:
                                                <ul class="cardList clearfix">

                                                    <li class="bank-online-methods ">
                                                        <label for="vcb_ck_on">
                                                            <i class="VCB" title="Ngân hàng TMCP Ngoại Thương Việt Nam"></i>
                                                            <input type="radio" ID="VCB" GroupName="bankcode" />

                                                        </label>
                                                    </li>

                                                    <li class="bank-online-methods ">
                                                        <label for="tcb_ck_on">
                                                            <i class="TCB" title="Ngân hàng Kỹ Thương"></i>
                                                            <input type="radio" ID="TCB" GroupName="bankcode" />
                                                        </label>
                                                    </li>

                                                    <li class="bank-online-methods ">
                                                        <label for="sml_atm_mb_ck_on">
                                                            <i class="MB" title="Ngân hàng Quân Đội"></i>
                                                            <input type="radio" ID="MB" GroupName="bankcode" />

                                                        </label>
                                                    </li>

                                                    <li class="bank-online-methods ">
                                                        <label for="sml_atm_vtb_ck_on">
                                                            <i class="ICB" title="Ngân hàng Công Thương Việt Nam"></i>
                                                            <input type="radio" ID="ICB" GroupName="bankcode" />

                                                        </label>
                                                    </li>

                                                    <li class="bank-online-methods ">
                                                        <label for="sml_atm_exb_ck_on">
                                                            <i class="EXB" title="Ngân hàng Xuất Nhập Khẩu"></i>
                                                            <input type="radio" ID="EXB" GroupName="bankcode" />

                                                        </label>
                                                    </li>

                                                    <li class="bank-online-methods ">
                                                        <label for="sml_atm_acb_ck_on">
                                                            <i class="ACB" title="Ngân hàng Á Châu"></i>
                                                            <input type="radio" ID="ACB" GroupName="bankcode" />

                                                        </label>
                                                    </li>

                                                    <li class="bank-online-methods ">
                                                        <label for="sml_atm_msb_ck_on">
                                                            <i class="MSB" title="Ngân hàng Hàng Hải"></i>
                                                            <input type="radio" ID="MSB" GroupName="bankcode" />

                                                        </label>
                                                    </li>

                                                    <li class="bank-online-methods ">
                                                        <label for="bnt_atm_agb_ck_on">
                                                            <i class="AGB" title="Ngân hàng Nông nghiệp &amp; Phát triển nông thôn"></i>
                                                            <input type="radio" ID="AGB" GroupName="bankcode" />

                                                        </label>
                                                    </li>

                                                </ul>
                                            </div>
                                            <div class="alert alert-danger" id="divMessage" style="display:none;"></div>
                                            <div class="clearfix"> </div>
                                        </form>

                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Thoát</button>
                                <button type="button" id="btnCreateOrder" class="btn btn-primary">Thanh toán</button>
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" id="btnCheckout" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModalScrollable">
                    Thanh toán
                </button>
                <div class="pull-right">
                    Tổng tiền: <span class="fw-bold text-primary">@Html.Action("TongTien", "giohang") VNĐ</span>  <span id="lblTotalOrder"></span>
                </div>
            </div>
            
        </div>
        
        <div class="clearfix"> </div>
    </div>

</div>

<script id="tplCart" type="x-tmpl-mustache">
  <tr>
    <td>{{ProductId}}</td>
    <td>{{ProductName}}</td>
    <td><img src="{{Image}}" height="50" /></td>
    <td>{{PriceF}}</td>
    <td><input type="number" data-id="{{ProductId}}" data-price="{{Price}}" value="{{Quantity}}" class="input txtQuantity" /></td>
    <td id="amount_{{ProductId}}">{{Amount}}</td>
    <td><button class="btn btn-danger btnDeleteItem" data-id="{{ProductId}}"><i class="fa fa-close"></i></button></td>
  </tr>

</script>
